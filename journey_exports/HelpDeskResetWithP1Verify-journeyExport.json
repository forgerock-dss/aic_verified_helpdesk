{
  "meta": {
    "origin": "https://openam-<tenant>/platform/?realm=alpha#/journeys/HelpDeskResetWithP1Verify",
    "exportedBy": "darinder.shokar@pingidentity.com",
    "exportDate": "2026-02-05T17:34:58.102Z",
    "exportTool": "platform-admin ui tree export",
    "exportToolVersion": "1.0",
    "treesSelectedForExport": [
      "HelpDeskResetWithP1Verify"
    ],
    "innerTreesIncluded": []
  },
  "trees": {
    "HelpDeskResetWithP1Verify": {
      "tree": {
        "_id": "HelpDeskResetWithP1Verify",
        "_rev": "-1384189552",
        "identityResource": "managed/alpha_user",
        "entryNodeId": "59401cf8-9618-4a58-b13c-d38d8515b73a",
        "innerTreeOnly": false,
        "description": "Help desk operative journey to invoke a user driven back channel journey to reset password via credential validation using PingOneVerify\npassword",
        "noSession": false,
        "mustRun": false,
        "enabled": true,
        "transactionalOnly": false,
        "uiConfig": {
          "categories": "[]",
          "annotations": "{\"forNodes\":{},\"structural\":[{\"id\":\"3a57a9ae-460a-4a99-b5d6-137824f2f89d\",\"text\":\"Help desk user login with role check to ensure only admins can execute this journey\",\"color\":\"yellow\",\"createdBy\":\"Darinder Shokar\",\"x\":141,\"y\":514.7666625976562,\"w\":500,\"h\":100},{\"id\":\"694156fc-f352-4941-9b0d-7c4dd75d87a9\",\"text\":\"Request the customer's email address, find the user and set user attributes in nodeState for Back Channel journey consumption\",\"color\":\"yellow\",\"createdBy\":\"Darinder Shokar\",\"x\":759,\"y\":101.76666259765625,\"w\":500,\"h\":148},{\"id\":\"4b82f9b5-83ff-4a85-a55e-13432f1687cb\",\"text\":\"Initialize the Back Channel user journey and send the user a magic link to validate ownership and enable user journey access\",\"color\":\"yellow\",\"createdBy\":\"Darinder Shokar\",\"x\":1779,\"y\":29.76666259765625,\"w\":500,\"h\":137},{\"id\":\"4d911c63-7f13-484c-80ae-36db7743bfb1\",\"text\":\"Poll Back Channel Journey Status and on success display a completed message to the help desk operative and exit the journey\",\"color\":\"yellow\",\"createdBy\":\"Darinder Shokar\",\"x\":2361,\"y\":15.76666259765625,\"w\":500,\"h\":139}]}"
        },
        "nodes": {
          "59401cf8-9618-4a58-b13c-d38d8515b73a": {
            "x": 32,
            "y": 908.5,
            "connections": {
              "outcome": "2fb14c74-aaa5-4de9-a554-e691354b8f27"
            },
            "nodeType": "PageNode",
            "displayName": "Page Node"
          },
          "bb5fcdbb-d2b2-439c-936c-410b5d6a2eb0": {
            "x": 565,
            "y": 626,
            "connections": {
              "false": "e301438c-0bd0-429c-ab0c-66126501069a",
              "true": "ec8b7018-39b1-4062-94ab-14ab28cab307"
            },
            "nodeType": "DataStoreDecisionNode",
            "displayName": "Data Store Decision"
          },
          "cff41a52-70b6-4e68-9c6d-c473dcd6982a": {
            "x": 1095,
            "y": 265.5,
            "connections": {
              "User_Not_Found": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "Next": "4c41752f-ebe9-4ce6-b8d1-ff5211a405d9"
            },
            "nodeType": "designer-83277447b5a24a6fa8a049a5ef90c8e8",
            "displayName": "Get IDM User Attributes"
          },
          "ec8b7018-39b1-4062-94ab-14ab28cab307": {
            "x": 796,
            "y": 449,
            "connections": {
              "Next": "cff41a52-70b6-4e68-9c6d-c473dcd6982a"
            },
            "nodeType": "PageNode",
            "displayName": "Page Node"
          },
          "2fb14c74-aaa5-4de9-a554-e691354b8f27": {
            "x": 290,
            "y": 761,
            "connections": {
              "true": "bb5fcdbb-d2b2-439c-936c-410b5d6a2eb0",
              "false": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "nodeType": "QueryFilterDecisionNode",
            "displayName": "Check User Is An Admin"
          },
          "4c41752f-ebe9-4ce6-b8d1-ff5211a405d9": {
            "x": 1384,
            "y": 122,
            "connections": {
              "Next": "775ba709-5d02-4433-ad7c-899db5de16e9",
              "Script Error": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "nodeType": "designer-c6e6d89db5a74c778ca464ccc38455ca",
            "displayName": "Set BackChannel State Properties"
          },
          "775ba709-5d02-4433-ad7c-899db5de16e9": {
            "x": 1766,
            "y": 186.5,
            "connections": {
              "unknown": "e301438c-0bd0-429c-ab0c-66126501069a",
              "error": "e301438c-0bd0-429c-ab0c-66126501069a",
              "created": "46a41750-cd0c-416d-b5f7-29f7b83d2e0a"
            },
            "nodeType": "BackChannelInitNode",
            "displayName": "Backchannel Initialize"
          },
          "46a41750-cd0c-416d-b5f7-29f7b83d2e0a": {
            "x": 2080,
            "y": 209,
            "connections": {
              "Success": "a7d4541d-2f43-4c89-98e4-e910b5a7b7d7",
              "Failed": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "nodeType": "ScriptedDecisionNode",
            "displayName": "Send User Magiclink"
          },
          "a7d4541d-2f43-4c89-98e4-e910b5a7b7d7": {
            "x": 2345,
            "y": 282,
            "connections": {
              "pending": "4ee72910-a11a-41b4-b739-86fef2b6092f",
              "inprogress": "4ee72910-a11a-41b4-b739-86fef2b6092f",
              "success": "34f7c0fa-3eca-4193-92de-feecc4bbaa98",
              "unknown": "e301438c-0bd0-429c-ab0c-66126501069a",
              "error": "e301438c-0bd0-429c-ab0c-66126501069a"
            },
            "nodeType": "BackChannelStatusNode",
            "displayName": "Backchannel Status"
          },
          "4ee72910-a11a-41b4-b739-86fef2b6092f": {
            "x": 2346,
            "y": 182,
            "connections": {
              "DONE": "a7d4541d-2f43-4c89-98e4-e910b5a7b7d7"
            },
            "nodeType": "PollingWaitNode",
            "displayName": "Polling Wait Node"
          },
          "34f7c0fa-3eca-4193-92de-feecc4bbaa98": {
            "x": 2601,
            "y": 384,
            "connections": {
              "Success": "42b0bb39-1ec3-4e18-8160-432501506008"
            },
            "nodeType": "designer-d0a055acaedd486b91fa88eddc6fccdb",
            "displayName": "User Message to Display"
          },
          "42b0bb39-1ec3-4e18-8160-432501506008": {
            "x": 2603.25,
            "y": 488.2083282470703,
            "connections": {
              "outcome": "70e691a5-1e33-4ac3-a356-e7b6d60d92e0"
            },
            "nodeType": "SetSuccessUrlNode",
            "displayName": "Success URL"
          }
        },
        "staticNodes": {
          "startNode": {
            "x": 70,
            "y": 231
          },
          "70e691a5-1e33-4ac3-a356-e7b6d60d92e0": {
            "x": 2870,
            "y": 493
          },
          "e301438c-0bd0-429c-ab0c-66126501069a": {
            "x": 1861,
            "y": 809
          }
        }
      },
      "nodes": {
        "59401cf8-9618-4a58-b13c-d38d8515b73a": {
          "_id": "59401cf8-9618-4a58-b13c-d38d8515b73a",
          "_rev": "1692445332",
          "nodes": [
            {
              "_id": "83458254-112c-442b-b954-2b82ffa818e1",
              "nodeType": "ValidatedUsernameNode",
              "displayName": "Platform Username"
            },
            {
              "_id": "488817f0-3dce-4b35-8aa3-6966ce238253",
              "nodeType": "ValidatedPasswordNode",
              "displayName": "Platform Password"
            }
          ],
          "pageDescription": {
            "en": "Please Sign In"
          },
          "pageHeader": {
            "en": "Help Desk Operative"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "bb5fcdbb-d2b2-439c-936c-410b5d6a2eb0": {
          "_id": "bb5fcdbb-d2b2-439c-936c-410b5d6a2eb0",
          "_rev": "-1417928836",
          "_type": {
            "_id": "DataStoreDecisionNode",
            "name": "Data Store Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "cff41a52-70b6-4e68-9c6d-c473dcd6982a": {
          "_id": "cff41a52-70b6-4e68-9c6d-c473dcd6982a",
          "_rev": "2021587186",
          "prefixNodeState": true,
          "attributeName": "mail",
          "subsetAttributes": [
            "_id",
            "mail",
            "userName"
          ],
          "realm": "alpha",
          "allAttributes": false,
          "prefixNodeStateValue": "customer",
          "attributeValue": "customer.email",
          "_type": {
            "_id": "designer-83277447b5a24a6fa8a049a5ef90c8e8",
            "name": "Get IDM User Attributes",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Next",
              "displayName": "Next"
            },
            {
              "id": "User_Not_Found",
              "displayName": "User_Not_Found"
            },
            {
              "id": "Error",
              "displayName": "Error"
            }
          ]
        },
        "ec8b7018-39b1-4062-94ab-14ab28cab307": {
          "_id": "ec8b7018-39b1-4062-94ab-14ab28cab307",
          "_rev": "-742169174",
          "nodes": [
            {
              "_id": "d725b4f9-048b-4c48-a53c-cfe0ad811ce8",
              "nodeType": "ScriptedDecisionNode",
              "displayName": "End User Email Address"
            }
          ],
          "pageDescription": {
            "en": "Enter Customer Email Address"
          },
          "pageHeader": {
            "en": "Customer Details"
          },
          "_type": {
            "_id": "PageNode",
            "name": "Page Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Next",
              "displayName": "Next"
            }
          ]
        },
        "2fb14c74-aaa5-4de9-a554-e691354b8f27": {
          "_id": "2fb14c74-aaa5-4de9-a554-e691354b8f27",
          "_rev": "-1749576257",
          "identityAttribute": "userName",
          "queryFilter": "frUnindexedString1 eq \"admin\"",
          "_type": {
            "_id": "QueryFilterDecisionNode",
            "name": "Query Filter Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "true",
              "displayName": "True"
            },
            {
              "id": "false",
              "displayName": "False"
            }
          ]
        },
        "4c41752f-ebe9-4ce6-b8d1-ff5211a405d9": {
          "_id": "4c41752f-ebe9-4ce6-b8d1-ff5211a405d9",
          "_rev": "925722215",
          "backChannelStateProperty": "backchannel:data",
          "attributeListProperty": [
            "customer.mail",
            "customer._id",
            "customer.userName"
          ],
          "_type": {
            "_id": "designer-c6e6d89db5a74c778ca464ccc38455ca",
            "name": "Set BackChannel State Properties",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Next",
              "displayName": "Next"
            },
            {
              "id": "Script Error",
              "displayName": "Script Error"
            }
          ]
        },
        "775ba709-5d02-4433-ad7c-899db5de16e9": {
          "_id": "775ba709-5d02-4433-ad7c-899db5de16e9",
          "_rev": "1479913396",
          "redirectUrlType": "GET",
          "usernameKey": "customer._id",
          "dataKey": "backchannel:data",
          "idType": "USER",
          "tree": "UserPasswordResetWithP1Verify",
          "timeout": 600,
          "_type": {
            "_id": "BackChannelInitNode",
            "name": "Backchannel Initialize",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "created",
              "displayName": "Created"
            },
            {
              "id": "unknown",
              "displayName": "Unknown Subject"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "46a41750-cd0c-416d-b5f7-29f7b83d2e0a": {
          "_id": "46a41750-cd0c-416d-b5f7-29f7b83d2e0a",
          "_rev": "1047558154",
          "script": "46c928e6-685d-433a-bd01-b68532d43557",
          "outcomes": [
            "Success",
            "Failed"
          ],
          "outputs": [
            "*"
          ],
          "inputs": [
            "*"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Success",
              "displayName": "Success"
            },
            {
              "id": "Failed",
              "displayName": "Failed"
            }
          ]
        },
        "a7d4541d-2f43-4c89-98e4-e910b5a7b7d7": {
          "_id": "a7d4541d-2f43-4c89-98e4-e910b5a7b7d7",
          "_rev": "1835105041",
          "recordData": true,
          "_type": {
            "_id": "BackChannelStatusNode",
            "name": "Backchannel Status",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "pending",
              "displayName": "Pending"
            },
            {
              "id": "inprogress",
              "displayName": "In Progress"
            },
            {
              "id": "success",
              "displayName": "Success"
            },
            {
              "id": "failure",
              "displayName": "Failure"
            },
            {
              "id": "unknown",
              "displayName": "Unknown"
            },
            {
              "id": "error",
              "displayName": "Error"
            }
          ]
        },
        "4ee72910-a11a-41b4-b739-86fef2b6092f": {
          "_id": "4ee72910-a11a-41b4-b739-86fef2b6092f",
          "_rev": "-1951417380",
          "spamDetectionTolerance": 3,
          "spamDetectionEnabled": false,
          "exitMessage": {},
          "waitingMessage": {
            "en": "Waiting for user to complete the PingOne Verification and password reset flow"
          },
          "secondsToWait": 5,
          "exitable": false,
          "_type": {
            "_id": "PollingWaitNode",
            "name": "Polling Wait Node",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "DONE",
              "displayName": "Done"
            }
          ]
        },
        "34f7c0fa-3eca-4193-92de-feecc4bbaa98": {
          "_id": "34f7c0fa-3eca-4193-92de-feecc4bbaa98",
          "_rev": "159950187",
          "message": "Customer reset password proccess successfully completed.",
          "_type": {
            "_id": "designer-d0a055acaedd486b91fa88eddc6fccdb",
            "name": "User Message to Display",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Success",
              "displayName": "Success"
            }
          ]
        },
        "42b0bb39-1ec3-4e18-8160-432501506008": {
          "_id": "42b0bb39-1ec3-4e18-8160-432501506008",
          "_rev": "1638478952",
          "successUrl": "https://hub.pingidentity.com/verified-helpdesk",
          "_type": {
            "_id": "SetSuccessUrlNode",
            "name": "Success URL",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        }
      },
      "innerNodes": {
        "83458254-112c-442b-b954-2b82ffa818e1": {
          "_id": "83458254-112c-442b-b954-2b82ffa818e1",
          "_rev": "1533062617",
          "usernameAttribute": "userName",
          "validateInput": false,
          "_type": {
            "_id": "ValidatedUsernameNode",
            "name": "Platform Username",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "488817f0-3dce-4b35-8aa3-6966ce238253": {
          "_id": "488817f0-3dce-4b35-8aa3-6966ce238253",
          "_rev": "-258144949",
          "validateInput": false,
          "passwordAttribute": "password",
          "_type": {
            "_id": "ValidatedPasswordNode",
            "name": "Platform Password",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "outcome",
              "displayName": "Outcome"
            }
          ]
        },
        "d725b4f9-048b-4c48-a53c-cfe0ad811ce8": {
          "_id": "d725b4f9-048b-4c48-a53c-cfe0ad811ce8",
          "_rev": "-1986725062",
          "script": "7925d6be-f29c-4e33-8f2b-766e88664bb3",
          "outcomes": [
            "Next"
          ],
          "outputs": [
            "*"
          ],
          "inputs": [
            "*"
          ],
          "_type": {
            "_id": "ScriptedDecisionNode",
            "name": "Scripted Decision",
            "collection": true,
            "version": "1.0"
          },
          "_outcomes": [
            {
              "id": "Next",
              "displayName": "Next"
            }
          ]
        }
      },
      "scripts": {
        "46c928e6-685d-433a-bd01-b68532d43557": {
          "_id": "46c928e6-685d-433a-bd01-b68532d43557",
          "name": "ds-customer-send-magic-link",
          "description": "Send a magic link to the user to initiate the back channel Verify journey in order to reset their password",
          "script": "\"/**\\n * @file This script sends a templated magiclink to a user via the IDM's configured email service\\n * using the openidm binding in next-gen scripting\\n * NOTE - The use of SendGrid is not supported in Production and must be changed to your own email service\\n * @version 0.1.1\\n * @keywords email mail magiclink sharedState transientState templateService\\n */\\n\\n/**\\n * Script configuration\\n*/\\nvar nodeConfig = {\\n\\n  mail: \\\"customer.email\\\",\\n  id: \\\"customer._id\\\",\\n  templateID: \\\"verifyResetPassword\\\",\\n  idmEndpoint: \\\"external/email\\\",\\n  idmAction: \\\"sendTemplate\\\"\\n};\\n\\n/**\\n * Node outcomes\\n*/\\nvar nodeOutcome = {\\n  SUCCESS: \\\"Success\\\",\\n  FAILED: \\\"Failed\\\"\\n};\\n\\n/**\\n * Send email via the IDM Email Service openidm binding in next-gen scripting\\n * \\n * @param {string} id - _id of user from sharedShare\\n * @param {string} email - mail attribute from sharedState\\n * @param {string} suspendLink - suspendLink containing the transactionId of the back channel journey and suspendId to continue the front channel journey\\n */\\n\\nfunction sendMail(id, email, suspendLink) {\\n  try {\\n    var templateId = nodeConfig.templateID;\\n    var idmEndpoint = nodeConfig.idmEndpoint;\\n    var idmAction = nodeConfig.idmAction;\\n    var identity = idRepository.getIdentity(id);\\n    var givenName = identity.getAttributeValues(\\\"givenName\\\").toArray()[0];\\n    var params = new Object();\\n\\n    params.templateName = templateId;\\n    params.to = email;\\n    params.object = {\\n      \\\"givenName\\\": givenName,\\n      \\\"resumeURI\\\": suspendLink\\n    };\\n\\n    openidm.action(idmEndpoint, idmAction, params);\\n    logger.debug(scriptName + \\\"Email send successfully\\\");\\n    return \\\"true\\\";\\n  }\\n  catch (e) {\\n    //Note script defaults to display user message on screen and does not follow the Failed outcome\\n    logger.error(scriptName + \\\": Failed to call IDM Email endpoint using template. Exception is: \\\" + e);\\n    return \\\"false\\\";\\n  }\\n};\\n\\n/**\\n * Main function\\n */\\n(function () {\\n  logger.error(scriptName + \\\": Node execution started\\\");\\n  var email;\\n  var suspendLink;\\n  var backchannelUrl;\\n\\n  //Exit if backchannel redirectUri not found in sharedState\\n  if (!(backchannelUrl = nodeState.get(\\\"backchannel-redirectUri\\\"))) {\\n    logger.error(scriptName + \\\": Unable to get backchannel-redirectUri from sharedState\\\");\\n    action.goTo(nodeOutcome.FAILED);\\n    return;\\n  }\\n  \\n  //Exit if mail to found sharedState\\n  if (!(email = nodeState.get(nodeConfig.mail))) {\\n    logger.error(scriptName + \\\": Unable to get mail from the sharedState attribute\\\");\\n    action.goTo(nodeOutcome.FAILED);\\n    return;\\n  }\\n\\n  //Exit if _id of user not found in sharedState\\n  if (!(id = nodeState.get(nodeConfig.id))) {\\n    logger.error(scriptName + \\\": Unable to get _id from sharedState attribute\\\");\\n    action.goTo(nodeOutcome.FAILED);\\n    return;\\n  }\\n\\n  //Send email with suspend link and exit\\n  sendMail(id, email, backchannelUrl);\\n  action.goTo(nodeOutcome.SUCCESS);\\n\\n})();\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=80f5c192-7bf5-4c64-bc37-b7f5664ac7f3,ou=user,ou=am-config",
          "creationDate": 1770287518003,
          "lastModifiedBy": "id=80f5c192-7bf5-4c64-bc37-b7f5664ac7f3,ou=user,ou=am-config",
          "lastModifiedDate": 1770295082278,
          "evaluatorVersion": "2.0"
        },
        "7925d6be-f29c-4e33-8f2b-766e88664bb3": {
          "_id": "7925d6be-f29c-4e33-8f2b-766e88664bb3",
          "name": "ds-get-customer-username",
          "description": null,
          "script": "\"/**\\n * Main function\\n * Prompts for the customer username\\n * If blank re-renders the prompt\\n * If present sets in nodeState to the value of nodeStateUserAttribute\\n */\\n\\n\\n(function () {\\n\\n  logger.error(scriptName + \\\": Node execution started\\\");\\n\\n  /**\\n   * Node outcomes\\n   */\\n  var nodeOutcomes = {\\n    NEXT: \\\"Next\\\"\\n  };\\n\\n  /**\\n * Node Config\\n */\\n  var nodeConfig = {\\n    nodeStateUserAttribute: \\\"customer.email\\\"\\n  };\\n\\n  if (callbacks.isEmpty()) {\\n    callbacksBuilder.nameCallback(\\\"Customer email\\\");\\n    return;\\n  }\\n\\n  var raw = callbacks.getNameCallbacks().get(0);\\n  var username = raw == null ? \\\"\\\" : String(raw).trim();\\n\\n  if (username.length === 0) {\\n    callbacksBuilder.nameCallback(\\\"Customer Email Address\\\");\\n    return;\\n  }\\n\\n  nodeState.putShared(nodeConfig.nodeStateUserAttribute, username);\\n  logger.error(scriptName + \\\" Node execution completed\\\");\\n  action.goTo(nodeOutcomes.NEXT);\\n\\n})();\"",
          "default": false,
          "language": "JAVASCRIPT",
          "context": "AUTHENTICATION_TREE_DECISION_NODE",
          "createdBy": "id=80f5c192-7bf5-4c64-bc37-b7f5664ac7f3,ou=user,ou=am-config",
          "creationDate": 1770240165386,
          "lastModifiedBy": "id=80f5c192-7bf5-4c64-bc37-b7f5664ac7f3,ou=user,ou=am-config",
          "lastModifiedDate": 1770286020856,
          "evaluatorVersion": "2.0"
        }
      },
      "emailTemplates": {},
      "socialIdentityProviders": {},
      "themes": [],
      "saml2Entities": {},
      "circlesOfTrust": {}
    }
  }
}